# Bioinformatics
## Analysis Strategy
## WGCNA

## ceRNA

## 肿瘤可变剪切

## 肿瘤预后判断
* 根据免疫细胞浸润程度判断预后（MCPcounter），获取预后相关表型
* 寻找与预后相关的分子

## 差异分析
* 常规方法
两组样品计算差异（log2FoldChange p-value）
<br>弊端：由于样本之间平行性较差或者当个样品间遗传背景的差异，组内取平均值肯能会掩盖部分关键基因的表达差异
* 新方法
<br>1.取小鼠原代细胞培养，分两组control和treatment，这样可规避遗传背景不同造成的影响。
<br>2.在计算每只小鼠的control-vs-treatment的差异，然后整合生物学重复的数据。
<br>3.对于有连续性表型的实验，可在2的基础上，计算基因表达与表型在样本间改变的相关性，根据相关性大小设定阈值筛选基因。

    例如：gene在各个con-treat对的log2FoldChange 与 各个con-treat的表型数据求相关性

## 基因过滤
* WGCNA处理方法
1.由于不推荐用差异基因筛选，故通过计算基因表达量大于某个值的样本在所有样本中的比率，比率大于70% 或80%的保留
2.计算所有基因的方差或标准差，从大到小排序，保留排名靠前一定比例的基因。
* RNA-seq使用方法
1.计算平均表达量，低于某一固定值得基因删除
* 新方法1
1.求基因间相关性，剔除与核心差异基因相关性较低的基因。（可剔除低表达量和存在误差的基因）

    
        #计算基因间相关性
        c <- cor(geneList) #使用WGCNA自带cor函数加速？
        #取绝对值
        C <- abs(cor)
        #循环设置相关性阈值（例如seq(0.3,0.9,0.02)），
        #将相关性矩阵中小于阈值的值赋值为0，得到新的矩阵C1
        G <- graph.adjacency(C1, mode='upper', weighted=T, diag=F) #？
        cc <- clusters(G) #？
        #cc$no就是网络所存在的聚类数目
        #cc$size就是每个聚类内的元素数目，若有多个聚类，提取其中最大的聚类，计算其中元素数目
        #画图
        #最终确定一个阈值，对基因进行筛选
        
 ## 筛选候选基因
 * 普遍方法
 根据差异基因结果进行富集分析，根据通路筛基因
 * 新方法
 <br>1.计算随机相关性
 
        1.将表型数据随机打乱顺序，求基因FC与随机表型数据相关性，重复1000次，取1000次平均值
        2.以横坐标为相关性，纵坐标为基因频率作图
 2.对基因进行富集
 
        1.利用基因FC与正确顺序表型相关性数据做上一步柱状图
        2.循环设置相关性阈值（例如seq(0.3,0.9,0.02)）
        3.计算每个阈值时的两个柱状图（曲线图）下的面积比率，
        4.面积比值最大的情况的基因则为最终的候选基因
 
